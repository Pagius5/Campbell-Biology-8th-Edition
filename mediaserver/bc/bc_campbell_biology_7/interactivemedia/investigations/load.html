<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<html>
<head>
	<title>Investigations Loading Page</title>
	
<script language="javascript">
<!---

// global vars
var inVars; //to hold name-value pairs
var chNum;
var orderNum;

// MAIN PROGRAM takes incoming name-vars string and passes it into a parser
var str = str ? str : location.search;
var query = str.charAt(0) == '?' ? str.substring(1) : str;
inVars = parseURLString(query); //this call populates the inVars array

// error-handling
if (inVars.length > 2) {
  alert("ERROR: too many variables in query string.");  
}
if (inVars[0] == null || inVars[1] == null) {
  alert("ERROR: empty query string.");  
}

// set chNum as a 2-digit number
if (inVars[0] > 0 && inVars[0] <10)
	chNum = "0" + inVars[0];
else
	chNum = inVars[0];

// access orderNum code table
switch (inVars[1]) {
	case "A":
		orderNum = "01";
		break;
	case "B":
		orderNum = "02";
		break;
	case "C":
		orderNum = "03";
		break;
	case "D":
		orderNum = "04";
		break;
	case "E":
		orderNum = "05";
		break;
	case "F":
		orderNum = "06";
		break;
	case "G":
		orderNum = "07";
		break;
	case "H":
		orderNum = "08";
		break;
	case "I":
		orderNum = "09";
		break;
	case "J":
		orderNum = "10";
		break;
	case "K":
		orderNum = "11";
		break;
	case "L":
		orderNum = "12";
		break;		
	case "M":
		orderNum = "13";
		break;	
	case "L":
		orderNum = "14";
		break;
	case "N":
		orderNum = "15";
		break;
	case "O":
		orderNum = "16";
		break;
	case "P":
		orderNum = "17";
		break;
	case "Q":
		orderNum = "18";
		break;
	case "R":
		orderNum = "19";
		break;
	case "S":
		orderNum = "20";
		break;
	case "T":
		orderNum = "21";
		break;
	case "U":
		orderNum = "22";
		break;
	case "V":
		orderNum = "23";
		break;
	case "W":
		orderNum = "24";
		break;
	case "X":
		orderNum = "25";
		break;
	case "Y":
		orderNum = "26";
		break;
	case "Z":
		orderNum = "12";
		break;
}

// redirect to investigation
document.location = "LPOS" + chNum + "/LPOS" + chNum + orderNum + "/index.html";
window.focus();

// used to read the title from the URL query string in order to have only one Free Trial info page
function parseURLString (query) {
  var retVars = new Array();

  if (query) {
    var fields = query.split('&');

    for (var i=0; i<fields.length; i++){
	  retVars[i] = unescape(fields[i].replace(/\+/g, ' '));
    }
  }
  // ret value is an array of type "splitVars"
  return retVars;
}


-->
</script>	
	
	
</head>

<body>



</body>
</html>
